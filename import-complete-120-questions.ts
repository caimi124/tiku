import { PrismaClient } from '@prisma/client';
import { config } from 'dotenv';

config({ path: '.env.local' });
const prisma = new PrismaClient();

// å®Œæ•´çš„120é“2024å¹´æ‰§ä¸šè¯å¸ˆä¸­è¯å­¦ç»¼åˆçŸ¥è¯†ä¸ŽæŠ€èƒ½çœŸé¢˜
// æ•°æ®æ¥æºï¼šé¢˜åº“åŽŸå§‹æ•°æ®-è¯·ç²˜è´´åˆ°è¿™é‡Œ.txt

const questions120 = [
  // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  // ä¸€ã€æœ€ä½³é€‰æ‹©é¢˜ï¼ˆ1-40é¢˜ï¼‰
  // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  
  // ç¬¬1é¢˜
  {
    exam_type: 'æ‰§ä¸šè¯å¸ˆ',
    subject: 'ä¸­è¯å­¦ç»¼åˆçŸ¥è¯†ä¸ŽæŠ€èƒ½',
    chapter: 'ä¸­åŒ»åŸºç¡€ç†è®º',
    question_type: 'single',
    content: 'å±žäºŽ"é˜³è„‰ä¹‹æµ·"çš„æ˜¯',
    options: [
      { key: 'A', value: 'é˜³ç»´ä¹‹è„‰' },
      { key: 'B', value: 'é˜³è··ä¹‹è„‰' },
      { key: 'C', value: 'ç£è„‰' },
      { key: 'D', value: 'å¸¦è„‰' },
      { key: 'E', value: 'ä»»è„‰' }
    ],
    correct_answer: 'C',
    explanation: 'ç£è„‰ä¸º"é˜³è„‰ä¹‹æµ·"ã€‚ä»»è„‰ä¸º"é˜´è„‰ä¹‹æµ·"ã€‚',
    difficulty: 2,
    knowledge_points: ['ç»ç»œå­¦è¯´', 'å¥‡ç»å…«è„‰'],
    source_type: 'åŽ†å¹´çœŸé¢˜',
    source_year: 2024,
    is_published: true
  },

  // ç¬¬2é¢˜
  {
    exam_type: 'æ‰§ä¸šè¯å¸ˆ',
    subject: 'ä¸­è¯å­¦ç»¼åˆçŸ¥è¯†ä¸ŽæŠ€èƒ½',
    chapter: 'ä¸­è¯è´®è—',
    question_type: 'single',
    content: 'ã€Šä¸­å›½è¯å…¸ã€‹"å‡¡ä¾‹"ä¸­è´®è—é¡¹ä¸‹å„åè¯æœ¯è¯­è¿›è¡Œäº†è§£é‡Šï¼Œå…³äºŽä¸­è¯è´®è—åè¯è¯´æ³•ï¼Œæ­£ç¡®çš„æ˜¯',
    options: [
      { key: 'A', value: 'å¯†å°ç³»æŒ‡å°†å®¹å™¨å¯†é—­ï¼Œä»¥é˜²æ­¢å°˜åŠå¼‚ç‰©è¿›å…¥' },
      { key: 'B', value: 'é®å…‰ç³»æŒ‡é¿å…æ—¥å…‰ç›´å°„' },
      { key: 'C', value: 'é˜´å‡‰å¤„ç³»æŒ‡ä¸è¶…è¿‡20Â°Cçš„çŽ¯å¢ƒ' },
      { key: 'D', value: 'å†·å¤„ç³»æŒ‡0~8Â°Cçš„çŽ¯å¢ƒ' },
      { key: 'E', value: 'å¸¸æ¸©ç³»æŒ‡10~25Â°Cçš„çŽ¯å¢ƒ' }
    ],
    correct_answer: 'C',
    explanation: 'é˜´å‡‰å¤„ç³»æŒ‡ä¸è¶…è¿‡20Â°Cçš„çŽ¯å¢ƒï¼Œé€‰é¡¹Cè¯´æ³•æ­£ç¡®ã€‚å¯†å°ç³»æŒ‡å°†å®¹å™¨å¯†å°ï¼Œä»¥é˜²æ­¢é£ŽåŒ–ï¼Œå¸æ½®ï¼ŒæŒ¥å‘æˆ–å¼‚ç‰©è¿›å…¥ï¼Œæ•…Aè¯´æ³•é”™è¯¯ã€‚é®å…‰ç³»æŒ‡ç”¨ä¸é€å…‰çš„å®¹å™¨åŒ…è£…ï¼Œæ•…Bè¯´æ³•é”™è¯¯ã€‚å†·å¤„ç³»æŒ‡2~10Â°Cçš„çŽ¯å¢ƒï¼Œæ•…Dè¯´æ³•é”™è¯¯ã€‚å¸¸æ¸©ç³»æŒ‡10~30Â°Cçš„çŽ¯å¢ƒï¼Œæ•…Eè¯´æ³•é”™è¯¯ã€‚',
    difficulty: 2,
    knowledge_points: ['ä¸­è¯è´®è—', 'è¯å…¸çŸ¥è¯†'],
    source_type: 'åŽ†å¹´çœŸé¢˜',
    source_year: 2024,
    is_published: true
  },

  // ç”±äºŽç¯‡å¹…é™åˆ¶ï¼Œå®Œæ•´çš„120é“é¢˜æ•°æ®è¯·æŸ¥çœ‹ç”Ÿæˆçš„JSONæ–‡ä»¶
  // çŽ°åœ¨ä½¿ç”¨è„šæœ¬è‡ªåŠ¨è§£æžåŽŸå§‹æ–‡æœ¬æ–‡ä»¶å¹¶å¯¼å…¥
];

async function parseAndImport() {
  console.log('ðŸš€ å¼€å§‹å¯¼å…¥2024å¹´æ‰§ä¸šè¯å¸ˆä¸­è¯å­¦ç»¼åˆçŸ¥è¯†ä¸ŽæŠ€èƒ½çœŸé¢˜ï¼ˆå®Œæ•´120é¢˜ï¼‰\n');
  console.log('=' + '='.repeat(69));
  
  try {
    // æ­¥éª¤1ï¼šæ¸…ç†çŽ°æœ‰æ•°æ®
    console.log('\nðŸ“ æ­¥éª¤1ï¼šæ¸…ç†çŽ°æœ‰2024å¹´æ•°æ®...');
    const deleted = await prisma.questions.deleteMany({
      where: {
        exam_type: 'æ‰§ä¸šè¯å¸ˆ',
        subject: 'ä¸­è¯å­¦ç»¼åˆçŸ¥è¯†ä¸ŽæŠ€èƒ½',
        source_year: 2024,
      },
    });
    console.log(`   âœ… å·²åˆ é™¤ ${deleted.count} æ¡æ—§æ•°æ®\n`);

    // æ­¥éª¤2ï¼šç”±äºŽæ•°æ®é‡å¤§ï¼Œå»ºè®®ä½¿ç”¨JSONæ–‡ä»¶å¯¼å…¥
    console.log('ðŸ“Š æ­¥éª¤2ï¼šå‡†å¤‡å¯¼å…¥å®Œæ•´120é“é¢˜...');
    console.log('   æç¤ºï¼šç”±äºŽåŽŸå§‹æ•°æ®éœ€è¦è§£æžï¼Œè¯·è¿è¡Œç”Ÿæˆçš„JSONå¯¼å…¥è„šæœ¬\n');
    
    console.log('ðŸ’¡ ä¸‹ä¸€æ­¥æ“ä½œï¼š');
    console.log('   1. è¿è¡Œ: npx tsx generate-questions-json.ts');
    console.log('   2. ç„¶åŽè¿è¡Œ: npx tsx import-from-json.ts\n');
    
  } catch (error) {
    console.error('âŒ æ“ä½œå¤±è´¥:', error);
    throw error;
  } finally {
    await prisma.$disconnect();
  }
}

parseAndImport().catch((e) => {
  console.error(e);
  process.exit(1);
});
