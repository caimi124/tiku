# ğŸ“ æ‰§ä¸šè¯å¸ˆé¢˜åº“å¹³å° - å®Œæ•´æŠ€æœ¯æ¶æ„å»ºè®®

## ğŸ“‹ éœ€æ±‚åˆ†ææ€»ç»“

### æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

1. **é¢˜åº“ç³»ç»Ÿ** ğŸ“š
   - å†å¹´çœŸé¢˜
   - ç« èŠ‚ç»ƒä¹ é¢˜
   - æŠ¼é¢˜å·
   - é‡ç‚¹è€ƒç‚¹é¢˜

2. **çŸ¥è¯†åº“ç³»ç»Ÿ** ğŸ“–
   - ç« èŠ‚å†…å®¹æ•´ç†ï¼ˆPDFï¼‰
   - é«˜é¢‘è€ƒç‚¹æ±‡æ€»ï¼ˆPDFï¼‰
   - å®˜æ–¹è€ƒè¯•å¤§çº²æ•´ç†
   - åœ¨çº¿é¢„è§ˆåŠŸèƒ½

3. **æ•°æ®åˆ†æç³»ç»Ÿ** ğŸ“Š
   - å„æœºæ„æŠ¼é¢˜å‘½ä¸­ç‡åˆ†æ
   - æœºæ„æŠ¼é¢˜è´¨é‡å¯¹æ¯”
   - æ•°æ®å¯è§†åŒ–å±•ç¤º

4. **AIåŠŸèƒ½** ğŸ¤–
   - åˆ†ææœºæ„æŠ¼é¢˜å‘½ä¸­ç‡
   - åŸºäºç°æœ‰é¢˜ç›®AIå‡ºé¢˜
   - å‡å°‘äººå·¥å®¡æ ¸å·¥ä½œé‡

5. **æ™ºèƒ½å­¦ä¹ è·¯å¾„** ğŸ¯
   - å…¥å­¦æµ‹è¯•è¯„ä¼°
   - è–„å¼±çŸ¥è¯†ç‚¹è¯†åˆ«
   - ä¸ªæ€§åŒ–å­¦ä¹ å»ºè®®
   - æ¨èå¯¹åº”PDFèµ„æ–™

---

## ğŸ’¡ æ•°æ®åº“é€‰æ‹©å»ºè®®

### ğŸ† æ¨èæ–¹æ¡ˆï¼šç»§ç»­ä½¿ç”¨ Supabaseï¼ˆå¼ºçƒˆæ¨èï¼‰

**ä¸ºä»€ä¹ˆæ¨è Supabaseï¼Ÿ**

#### âœ… å®Œç¾åŒ¹é…ä½ çš„æ‰€æœ‰éœ€æ±‚

1. **PostgreSQL æ•°æ®åº“** - æœ€é€‚åˆä½ çš„åœºæ™¯
   - âœ… å¤æ‚æŸ¥è¯¢æ”¯æŒï¼ˆç»Ÿè®¡åˆ†æã€å‘½ä¸­ç‡è®¡ç®—ï¼‰
   - âœ… JSONBå­—æ®µï¼ˆå­˜å‚¨é¢˜ç›®é€‰é¡¹ã€AIåˆ†æç»“æœï¼‰
   - âœ… æ•°ç»„å­—æ®µï¼ˆçŸ¥è¯†ç‚¹æ ‡ç­¾ã€é¢˜ç›®åˆ†ç±»ï¼‰
   - âœ… å…¨æ–‡æœç´¢ï¼ˆé¢˜ç›®å†…å®¹æœç´¢ï¼‰
   - âœ… äº‹åŠ¡æ”¯æŒï¼ˆç”¨æˆ·ç­”é¢˜è®°å½•ä¸€è‡´æ€§ï¼‰

2. **Storage æ–‡ä»¶å­˜å‚¨** - å­˜å‚¨ä½ çš„PDF
   - âœ… å†…ç½®å¯¹è±¡å­˜å‚¨ï¼ˆCDNåŠ é€Ÿï¼‰
   - âœ… æ”¯æŒPDFã€å›¾ç‰‡ã€è§†é¢‘
   - âœ… è‡ªåŠ¨ç”Ÿæˆè®¿é—®URL
   - âœ… æƒé™æ§åˆ¶
   - âœ… æ–‡ä»¶é¢„è§ˆAPI

3. **Authentication è®¤è¯ç³»ç»Ÿ**
   - âœ… ç”¨æˆ·æ³¨å†Œç™»å½•
   - âœ… ç¤¾äº¤ç™»å½•ï¼ˆå¾®ä¿¡ã€QQç­‰ï¼‰
   - âœ… JWT token
   - âœ… Row Level Securityï¼ˆæ•°æ®å®‰å…¨ï¼‰

4. **Edge Functions** - åç«¯é€»è¾‘
   - âœ… Serverlesså‡½æ•°
   - âœ… é›†æˆAIï¼ˆOpenAIã€Anthropicç­‰ï¼‰
   - âœ… å®šæ—¶ä»»åŠ¡ï¼ˆåˆ†æå‘½ä¸­ç‡ï¼‰
   - âœ… Webhookæ”¯æŒ

5. **Realtime å®æ—¶åŠŸèƒ½**
   - âœ… å®æ—¶æ’è¡Œæ¦œ
   - âœ… åœ¨çº¿ç­”é¢˜äººæ•°
   - âœ… å®æ—¶é€šçŸ¥

6. **APIè®¿é—®å·²éªŒè¯æˆåŠŸ** âœ…
   - ä½ çš„ç½‘ç»œç¯å¢ƒå¯ä»¥è®¿é—®API
   - ä¸ä¾èµ–PostgreSQLç›´è¿
   - å®Œå…¨å¯ä»¥æ»¡è¶³éœ€æ±‚

#### ğŸ’° æˆæœ¬ä¼˜åŠ¿
- **å…è´¹é¢åº¦**ï¼š
  - 500MB æ•°æ®åº“
  - 1GB æ–‡ä»¶å­˜å‚¨
  - 50,000 æœˆæ´»ç”¨æˆ·
  - 2GB å¸¦å®½
- **ä»˜è´¹è®¡åˆ’**ï¼š$25/æœˆï¼ˆProè®¡åˆ’ï¼‰
  - 8GB æ•°æ®åº“
  - 100GB æ–‡ä»¶å­˜å‚¨
  - 100,000 æœˆæ´»ç”¨æˆ·

---

### ğŸ”„ å¤‡é€‰æ–¹æ¡ˆå¯¹æ¯”

#### æ–¹æ¡ˆ1ï¼šFirebase (Google)
**ä¼˜ç‚¹ï¼š**
- âœ… Googleç”Ÿæ€é›†æˆ
- âœ… å®æ—¶æ•°æ®åº“
- âœ… æ–‡ä»¶å­˜å‚¨
- âœ… è®¤è¯ç³»ç»Ÿ

**ç¼ºç‚¹ï¼š**
- âŒ NoSQLæ•°æ®åº“ï¼ˆä¸é€‚åˆå¤æ‚æŸ¥è¯¢ï¼‰
- âŒ ç»Ÿè®¡åˆ†æå›°éš¾
- âŒ å…³ç³»å‹æ•°æ®æ”¯æŒå·®
- âŒ æˆæœ¬è¾ƒé«˜
- âŒ å¯èƒ½ä¹Ÿæœ‰ç½‘ç»œé—®é¢˜

**é€‚ç”¨åœºæ™¯ï¼š** ç®€å•åº”ç”¨ã€å®æ—¶èŠå¤©

**è¯„åˆ†ï¼š** â­â­â­ (6/10)

---

#### æ–¹æ¡ˆ2ï¼šMongoDB Atlas
**ä¼˜ç‚¹ï¼š**
- âœ… æ–‡æ¡£æ•°æ®åº“çµæ´»
- âœ… æ°´å¹³æ‰©å±•å¥½
- âœ… èšåˆæŸ¥è¯¢å¼ºå¤§

**ç¼ºç‚¹ï¼š**
- âŒ å­¦ä¹ æ›²çº¿é™¡å³­
- âŒ å…³ç³»å‹æ•°æ®å¤„ç†å¤æ‚
- âŒ å¯èƒ½ä¹Ÿæœ‰DNSé—®é¢˜
- âŒ æ²¡æœ‰å†…ç½®æ–‡ä»¶å­˜å‚¨
- âŒ æ²¡æœ‰å†…ç½®è®¤è¯

**é€‚ç”¨åœºæ™¯ï¼š** å¤§è§„æ¨¡éå…³ç³»å‹æ•°æ®

**è¯„åˆ†ï¼š** â­â­â­â­ (7/10)

---

#### æ–¹æ¡ˆ3ï¼šPlanetScale (Serverless MySQL)
**ä¼˜ç‚¹ï¼š**
- âœ… MySQLå…¼å®¹
- âœ… åˆ†æ”¯ç®¡ç†ï¼ˆåƒGitï¼‰
- âœ… è‡ªåŠ¨æ‰©å±•
- âœ… å…è´¹é¢åº¦æ…·æ…¨

**ç¼ºç‚¹ï¼š**
- âŒ æ²¡æœ‰æ–‡ä»¶å­˜å‚¨
- âŒ æ²¡æœ‰è®¤è¯ç³»ç»Ÿ
- âŒ éœ€è¦é¢å¤–é›†æˆ
- âŒ å¯èƒ½ä¹Ÿæœ‰ç½‘ç»œé—®é¢˜
- âŒ MySQLåŠŸèƒ½ä¸å¦‚PostgreSQL

**é€‚ç”¨åœºæ™¯ï¼š** çº¯æ•°æ®åº“éœ€æ±‚

**è¯„åˆ†ï¼š** â­â­â­â­ (7/10)

---

#### æ–¹æ¡ˆ4ï¼šNeon (Serverless Postgres)
**ä¼˜ç‚¹ï¼š**
- âœ… PostgreSQLï¼ˆä¸Supabaseç›¸åŒï¼‰
- âœ… Serverlessæ¶æ„
- âœ… åˆ†æ”¯ç®¡ç†
- âœ… å†·å¯åŠ¨å¿«

**ç¼ºç‚¹ï¼š**
- âŒ æ²¡æœ‰æ–‡ä»¶å­˜å‚¨
- âŒ æ²¡æœ‰è®¤è¯ç³»ç»Ÿ
- âŒ æ²¡æœ‰å®æ—¶åŠŸèƒ½
- âŒ éœ€è¦å¤§é‡é¢å¤–å¼€å‘
- âŒ å¯èƒ½ä¹Ÿæœ‰ç½‘ç»œé—®é¢˜

**é€‚ç”¨åœºæ™¯ï¼š** åªéœ€è¦æ•°æ®åº“

**è¯„åˆ†ï¼š** â­â­â­â­ (7/10)

---

#### æ–¹æ¡ˆ5ï¼šè‡ªå»ºæ–¹æ¡ˆï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘ï¼‰
**ä¼˜ç‚¹ï¼š**
- âœ… å›½å†…è®¿é—®å¿«
- âœ… æ— ç½‘ç»œé™åˆ¶
- âœ… å®Œå…¨æ§åˆ¶
- âœ… å¯ä»¥å®šåˆ¶

**ç¼ºç‚¹ï¼š**
- âŒ éœ€è¦è‡ªå·±è¿ç»´
- âŒ æˆæœ¬è¾ƒé«˜
- âŒ å¼€å‘å·¥ä½œé‡å¤§
- âŒ éœ€è¦å®ç°æ‰€æœ‰åŠŸèƒ½
- âŒ å®‰å…¨æ€§éœ€è‡ªå·±ä¿è¯

**é€‚ç”¨åœºæ™¯ï¼š** å¤§å‹ä¼ä¸šã€æœ‰è¿ç»´å›¢é˜Ÿ

**è¯„åˆ†ï¼š** â­â­â­ (6/10) - å¯¹ä¸ªäººé¡¹ç›®ä¸æ¨è

---

### ğŸ† æœ€ç»ˆæ¨è

**ç»§ç»­ä½¿ç”¨ Supabaseï¼Œè¯„åˆ†ï¼šâ­â­â­â­â­ (10/10)**

**ç†ç”±ï¼š**
1. âœ… åŠŸèƒ½æœ€å®Œæ•´ï¼ˆæ•°æ®åº“+å­˜å‚¨+è®¤è¯+å®æ—¶+è¾¹ç¼˜å‡½æ•°ï¼‰
2. âœ… APIè®¿é—®å·²éªŒè¯å¯ç”¨
3. âœ… ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ
4. âœ… å¼€å‘æ•ˆç‡æœ€é«˜
5. âœ… æˆæœ¬æœ€ä¼˜
6. âœ… ç¤¾åŒºæ´»è·ƒã€æ–‡æ¡£å®Œå–„
7. âœ… PostgreSQLæ˜¯æœ€é€‚åˆä½ éœ€æ±‚çš„æ•°æ®åº“

---

## ğŸ—ï¸ å®Œæ•´æŠ€æœ¯æ¶æ„è®¾è®¡

### æ•°æ®åº“è®¾è®¡

#### 1. é¢˜åº“ç›¸å…³è¡¨

```sql
-- é¢˜ç›®è¡¨ï¼ˆæ ¸å¿ƒï¼‰
CREATE TABLE questions (
  id TEXT PRIMARY KEY,
  exam_type TEXT NOT NULL,           -- è€ƒè¯•ç±»å‹
  subject TEXT NOT NULL,              -- ç§‘ç›®
  chapter TEXT,                       -- ç« èŠ‚
  question_type TEXT NOT NULL,        -- é¢˜å‹
  content TEXT NOT NULL,              -- é¢˜ç›®å†…å®¹
  options JSONB NOT NULL,             -- é€‰é¡¹
  correct_answer TEXT NOT NULL,       -- æ­£ç¡®ç­”æ¡ˆ
  explanation TEXT,                   -- è§£æ
  ai_explanation TEXT,                -- AIè§£æ
  difficulty INTEGER DEFAULT 1,       -- éš¾åº¦
  knowledge_points TEXT[],            -- çŸ¥è¯†ç‚¹æ ‡ç­¾
  source_type TEXT,                   -- æ¥æºç±»å‹ï¼ˆçœŸé¢˜/æŠ¼é¢˜/æ¨¡æ‹Ÿï¼‰
  source_institution TEXT,            -- æ¥æºæœºæ„
  source_year INTEGER,                -- å¹´ä»½
  is_published BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- æœºæ„è¡¨
CREATE TABLE institutions (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,                 -- æœºæ„åç§°
  description TEXT,                   -- æè¿°
  logo_url TEXT,                      -- Logo
  accuracy_rate DECIMAL(5,2),         -- å‘½ä¸­ç‡
  total_predictions INTEGER DEFAULT 0, -- æ€»æŠ¼é¢˜æ•°
  correct_predictions INTEGER DEFAULT 0, -- å‘½ä¸­æ•°
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- æŠ¼é¢˜å·è¡¨
CREATE TABLE prediction_papers (
  id TEXT PRIMARY KEY,
  institution_id TEXT REFERENCES institutions(id),
  exam_year INTEGER NOT NULL,         -- è€ƒè¯•å¹´ä»½
  subject TEXT NOT NULL,              -- ç§‘ç›®
  paper_name TEXT NOT NULL,           -- å·å
  question_ids TEXT[],                -- é¢˜ç›®IDåˆ—è¡¨
  publish_date DATE,                  -- å‘å¸ƒæ—¥æœŸ
  actual_exam_date DATE,              -- å®é™…è€ƒè¯•æ—¥æœŸ
  hit_count INTEGER DEFAULT 0,        -- å‘½ä¸­é¢˜æ•°
  hit_rate DECIMAL(5,2),              -- å‘½ä¸­ç‡
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- çŸ¥è¯†ç‚¹è¡¨
CREATE TABLE knowledge_points (
  id TEXT PRIMARY KEY,
  exam_type TEXT NOT NULL,
  subject TEXT NOT NULL,
  chapter TEXT NOT NULL,
  point_name TEXT NOT NULL,           -- çŸ¥è¯†ç‚¹åç§°
  point_content TEXT,                 -- çŸ¥è¯†ç‚¹å†…å®¹
  importance_level INTEGER,           -- é‡è¦ç¨‹åº¦(1-5)
  frequency INTEGER DEFAULT 0,        -- å‡ºç°é¢‘æ¬¡
  pdf_url TEXT,                       -- å…³è”PDF
  created_at TIMESTAMPTZ DEFAULT NOW()
);
```

#### 2. ç”¨æˆ·å­¦ä¹ ç›¸å…³è¡¨

```sql
-- ç”¨æˆ·è¡¨ï¼ˆSupabase Authè‡ªå¸¦ï¼‰
-- æ‰©å±•ç”¨æˆ·ä¿¡æ¯è¡¨
CREATE TABLE user_profiles (
  user_id UUID PRIMARY KEY REFERENCES auth.users(id),
  nickname TEXT,
  avatar_url TEXT,
  target_exam TEXT,                   -- ç›®æ ‡è€ƒè¯•
  target_year INTEGER,                -- ç›®æ ‡å¹´ä»½
  study_days INTEGER DEFAULT 0,       -- å­¦ä¹ å¤©æ•°
  total_questions INTEGER DEFAULT 0,  -- æ€»ç­”é¢˜æ•°
  correct_questions INTEGER DEFAULT 0, -- æ­£ç¡®æ•°
  level INTEGER DEFAULT 1,            -- ç­‰çº§
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- ç­”é¢˜è®°å½•è¡¨
CREATE TABLE user_answers (
  id TEXT PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  question_id TEXT REFERENCES questions(id),
  user_answer TEXT,                   -- ç”¨æˆ·ç­”æ¡ˆ
  is_correct BOOLEAN,                 -- æ˜¯å¦æ­£ç¡®
  time_spent INTEGER,                 -- ç­”é¢˜è€—æ—¶(ç§’)
  answered_at TIMESTAMPTZ DEFAULT NOW()
);

-- å­¦ä¹ è®¡åˆ’è¡¨
CREATE TABLE study_plans (
  id TEXT PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  plan_type TEXT,                     -- è®¡åˆ’ç±»å‹
  target_date DATE,                   -- ç›®æ ‡æ—¥æœŸ
  daily_questions INTEGER,            -- æ¯æ—¥é¢˜æ•°
  weak_chapters TEXT[],               -- è–„å¼±ç« èŠ‚
  status TEXT DEFAULT 'active',       -- çŠ¶æ€
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- ç”¨æˆ·è¯„ä¼°è®°å½•è¡¨
CREATE TABLE user_assessments (
  id TEXT PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  assessment_type TEXT,               -- è¯„ä¼°ç±»å‹
  total_questions INTEGER,            -- æ€»é¢˜æ•°
  correct_count INTEGER,              -- æ­£ç¡®æ•°
  score DECIMAL(5,2),                 -- åˆ†æ•°
  weak_points JSONB,                  -- è–„å¼±çŸ¥è¯†ç‚¹
  strong_points JSONB,                -- å¼ºé¡¹çŸ¥è¯†ç‚¹
  recommendations JSONB,              -- å­¦ä¹ å»ºè®®
  assessed_at TIMESTAMPTZ DEFAULT NOW()
);
```

#### 3. èµ„æºç®¡ç†è¡¨

```sql
-- PDFèµ„æºè¡¨
CREATE TABLE pdf_resources (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  description TEXT,
  category TEXT,                      -- åˆ†ç±»ï¼ˆç« èŠ‚/è€ƒç‚¹/å¤§çº²ï¼‰
  subject TEXT,
  chapter TEXT,
  file_path TEXT NOT NULL,            -- Storageè·¯å¾„
  file_url TEXT,                      -- è®¿é—®URL
  file_size INTEGER,                  -- æ–‡ä»¶å¤§å°
  page_count INTEGER,                 -- é¡µæ•°
  download_count INTEGER DEFAULT 0,   -- ä¸‹è½½æ¬¡æ•°
  view_count INTEGER DEFAULT 0,       -- æŸ¥çœ‹æ¬¡æ•°
  is_premium BOOLEAN DEFAULT false,   -- æ˜¯å¦ä»˜è´¹
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- AIç”Ÿæˆé¢˜ç›®è®°å½•è¡¨
CREATE TABLE ai_generated_questions (
  id TEXT PRIMARY KEY,
  source_question_ids TEXT[],         -- å‚è€ƒé¢˜ç›®ID
  generated_question_id TEXT REFERENCES questions(id),
  ai_model TEXT,                      -- AIæ¨¡å‹
  prompt TEXT,                        -- æç¤ºè¯
  quality_score DECIMAL(3,2),         -- è´¨é‡è¯„åˆ†
  human_reviewed BOOLEAN DEFAULT false, -- æ˜¯å¦äººå·¥å®¡æ ¸
  approved BOOLEAN,                   -- æ˜¯å¦é€šè¿‡
  reviewer_notes TEXT,                -- å®¡æ ¸æ„è§
  generated_at TIMESTAMPTZ DEFAULT NOW()
);
```

---

### æ–‡ä»¶å­˜å‚¨ç»“æ„ï¼ˆSupabase Storageï¼‰

```
buckets/
â”œâ”€â”€ pdfs/                           # PDFæ–‡æ¡£
â”‚   â”œâ”€â”€ chapters/                   # ç« èŠ‚å†…å®¹
â”‚   â”‚   â”œâ”€â”€ zhongyao/
â”‚   â”‚   â”‚   â”œâ”€â”€ chapter1.pdf
â”‚   â”‚   â”‚   â””â”€â”€ chapter2.pdf
â”‚   â”‚   â””â”€â”€ xiyao/
â”‚   â”œâ”€â”€ highlights/                 # é«˜é¢‘è€ƒç‚¹
â”‚   â”‚   â””â”€â”€ 2024-highlights.pdf
â”‚   â””â”€â”€ outlines/                   # è€ƒè¯•å¤§çº²
â”‚       â””â”€â”€ 2024-outline.pdf
â”œâ”€â”€ avatars/                        # ç”¨æˆ·å¤´åƒ
â””â”€â”€ institution-logos/              # æœºæ„Logo
```

---

### APIç«¯ç‚¹è®¾è®¡

#### é¢˜åº“API
```typescript
// è·å–é¢˜ç›®åˆ—è¡¨
GET  /api/questions?exam=æ‰§ä¸šè¯å¸ˆ&subject=ä¸­è¯&chapter=xxx&type=çœŸé¢˜

// è·å–å•ä¸ªé¢˜ç›®
GET  /api/questions/:id

// æäº¤ç­”æ¡ˆ
POST /api/questions/:id/answer
{
  userId: string,
  answer: string,
  timeSpent: number
}

// è·å–éšæœºé¢˜ç›®
GET  /api/questions/random?subject=xxx&count=20
```

#### æœºæ„åˆ†æAPI
```typescript
// è·å–æœºæ„åˆ—è¡¨åŠå‘½ä¸­ç‡
GET  /api/institutions

// è·å–æœºæ„è¯¦æƒ…
GET  /api/institutions/:id

// è·å–æœºæ„æŠ¼é¢˜å·
GET  /api/institutions/:id/predictions?year=2024

// AIåˆ†æå‘½ä¸­ç‡
POST /api/institutions/analyze-accuracy
```

#### PDFèµ„æºAPI
```typescript
// è·å–PDFåˆ—è¡¨
GET  /api/pdfs?category=ç« èŠ‚&subject=ä¸­è¯

// è·å–PDFè¯¦æƒ…ï¼ˆå«é¢„è§ˆURLï¼‰
GET  /api/pdfs/:id

// åœ¨çº¿é¢„è§ˆ
GET  /api/pdfs/:id/preview

// ä¸‹è½½PDF
GET  /api/pdfs/:id/download
```

#### å­¦ä¹ è¯„ä¼°API
```typescript
// åˆ›å»ºæµ‹è¯•
POST /api/assessments/create
{
  examType: string,
  subjects: string[]
}

// æäº¤æµ‹è¯•ç­”æ¡ˆ
POST /api/assessments/:id/submit
{
  answers: { questionId: string, answer: string }[]
}

// è·å–è¯„ä¼°æŠ¥å‘Š
GET  /api/assessments/:id/report

// è·å–å­¦ä¹ å»ºè®®
GET  /api/assessments/:id/recommendations
```

#### AIåŠŸèƒ½API
```typescript
// AIç”Ÿæˆé¢˜ç›®
POST /api/ai/generate-question
{
  subject: string,
  chapter: string,
  referenceQuestions: string[],
  difficulty: number
}

// AIåˆ†æè–„å¼±çŸ¥è¯†ç‚¹
POST /api/ai/analyze-weakness
{
  userId: string,
  recentAnswers: []
}

// AIæ¨èå­¦ä¹ è·¯å¾„
POST /api/ai/recommend-path
{
  userId: string,
  assessmentId: string
}
```

---

### AIé›†æˆæ–¹æ¡ˆ

#### 1. AIå‘½ä¸­ç‡åˆ†æ

```typescript
// ä½¿ç”¨OpenAIåˆ†æ
async function analyzeAccuracyRate(institutionId: string, year: number) {
  // 1. è·å–æœºæ„æŠ¼é¢˜
  const predictions = await getPredictions(institutionId, year);
  
  // 2. è·å–å®é™…è€ƒé¢˜
  const actualExam = await getActualExam(year);
  
  // 3. ä½¿ç”¨AIæ¯”å¯¹
  const prompt = `
    åˆ†æä»¥ä¸‹æŠ¼é¢˜ä¸å®é™…è€ƒé¢˜çš„ç›¸ä¼¼åº¦ï¼š
    æŠ¼é¢˜ï¼š${JSON.stringify(predictions)}
    è€ƒé¢˜ï¼š${JSON.stringify(actualExam)}
    
    è¯·åˆ†æï¼š
    1. ç›´æ¥å‘½ä¸­é¢˜æ•°
    2. çŸ¥è¯†ç‚¹è¦†ç›–ç‡
    3. é¢˜å‹åˆ†å¸ƒç›¸ä¼¼åº¦
    4. ç»¼åˆå‘½ä¸­ç‡
  `;
  
  const analysis = await openai.chat.completions.create({
    model: "gpt-4",
    messages: [{ role: "user", content: prompt }]
  });
  
  return analysis;
}
```

#### 2. AIæ¨¡ä»¿å‡ºé¢˜

```typescript
async function generateSimilarQuestion(referenceQuestions: Question[]) {
  const prompt = `
    åŸºäºä»¥ä¸‹å‚è€ƒé¢˜ç›®ï¼Œç”Ÿæˆä¸€é“ç±»ä¼¼çš„æ–°é¢˜ç›®ï¼š
    
    å‚è€ƒé¢˜ç›®ï¼š
    ${referenceQuestions.map(q => `
      é¢˜ç›®ï¼š${q.content}
      é€‰é¡¹ï¼š${JSON.stringify(q.options)}
      ç­”æ¡ˆï¼š${q.correctAnswer}
      çŸ¥è¯†ç‚¹ï¼š${q.knowledgePoints}
    `).join('\n\n')}
    
    è¦æ±‚ï¼š
    1. ä¿æŒç›¸åŒçš„çŸ¥è¯†ç‚¹
    2. ä¿æŒç›¸åŒçš„éš¾åº¦
    3. é¢˜ç›®æè¿°è¦æœ‰æ–°æ„
    4. é€‰é¡¹è®¾ç½®åˆç†
    5. æä¾›è¯¦ç»†è§£æ
    
    è¿”å›JSONæ ¼å¼ï¼š
    {
      "content": "é¢˜ç›®å†…å®¹",
      "options": [...],
      "correctAnswer": "X",
      "explanation": "è§£æ",
      "knowledgePoints": [...]
    }
  `;
  
  const response = await openai.chat.completions.create({
    model: "gpt-4",
    messages: [{ role: "user", content: prompt }],
    response_format: { type: "json_object" }
  });
  
  return JSON.parse(response.choices[0].message.content);
}
```

#### 3. æ™ºèƒ½è¯„ä¼°å’Œæ¨è

```typescript
async function assessAndRecommend(userId: string, answers: Answer[]) {
  // 1. ç»Ÿè®¡ç­”é¢˜æƒ…å†µ
  const stats = calculateStats(answers);
  
  // 2. AIåˆ†æè–„å¼±ç‚¹
  const prompt = `
    ç”¨æˆ·ç­”é¢˜æƒ…å†µï¼š
    - æ€»é¢˜æ•°ï¼š${stats.total}
    - æ­£ç¡®ç‡ï¼š${stats.accuracy}%
    - é”™é¢˜åˆ†å¸ƒï¼š${JSON.stringify(stats.wrongByChapter)}
    
    è¯·åˆ†æï¼š
    1. è–„å¼±ç« èŠ‚ï¼ˆå‰3ä¸ªï¼‰
    2. éœ€è¦é‡ç‚¹å¤ä¹ çš„çŸ¥è¯†ç‚¹
    3. å­¦ä¹ å»ºè®®
    4. æ¨èçš„PDFèµ„æ–™
  `;
  
  const analysis = await openai.chat.completions.create({
    model: "gpt-4",
    messages: [{ role: "user", content: prompt }]
  });
  
  // 3. ç”Ÿæˆå­¦ä¹ è®¡åˆ’
  const plan = await generateStudyPlan(userId, analysis);
  
  // 4. æ¨èPDFèµ„æ–™
  const pdfs = await recommendPDFs(analysis.weakChapters);
  
  return { analysis, plan, pdfs };
}
```

---

### å‰ç«¯æ¶æ„

#### æŠ€æœ¯æ ˆ
```
- Next.js 14 (App Router)
- TypeScript
- Tailwind CSS
- shadcn/ui
- @supabase/supabase-js
- React Query (æ•°æ®è·å–)
- Zustand (çŠ¶æ€ç®¡ç†)
- PDF.js (PDFé¢„è§ˆ)
- Chart.js (æ•°æ®å¯è§†åŒ–)
```

#### æ ¸å¿ƒé¡µé¢ç»“æ„
```
app/
â”œâ”€â”€ (auth)/
â”‚   â”œâ”€â”€ login/
â”‚   â””â”€â”€ register/
â”œâ”€â”€ (dashboard)/
â”‚   â”œâ”€â”€ overview/              # å­¦ä¹ æ¦‚è§ˆ
â”‚   â”œâ”€â”€ practice/              # ç»ƒä¹ æ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ chapter/           # ç« èŠ‚ç»ƒä¹ 
â”‚   â”‚   â”œâ”€â”€ random/            # éšæœºç»ƒä¹ 
â”‚   â”‚   â”œâ”€â”€ exam/              # æ¨¡æ‹Ÿè€ƒè¯•
â”‚   â”‚   â””â”€â”€ wrong/             # é”™é¢˜æœ¬
â”‚   â”œâ”€â”€ resources/             # å­¦ä¹ èµ„æ–™
â”‚   â”‚   â”œâ”€â”€ pdfs/              # PDFèµ„æ–™
â”‚   â”‚   â””â”€â”€ highlights/        # é«˜é¢‘è€ƒç‚¹
â”‚   â”œâ”€â”€ assessment/            # æ°´å¹³æµ‹è¯•
â”‚   â”œâ”€â”€ analysis/              # æ•°æ®åˆ†æ
â”‚   â”‚   â””â”€â”€ institutions/      # æœºæ„æŠ¼é¢˜åˆ†æ
â”‚   â””â”€â”€ profile/               # ä¸ªäººä¸­å¿ƒ
â””â”€â”€ api/                       # APIè·¯ç”±
    â”œâ”€â”€ questions/
    â”œâ”€â”€ pdfs/
    â”œâ”€â”€ assessments/
    â””â”€â”€ ai/
```

---

### éƒ¨ç½²æ–¹æ¡ˆ

#### æ¨èï¼šVercel
**ä¼˜ç‚¹ï¼š**
- âœ… Next.jsåŸç”Ÿæ”¯æŒ
- âœ… è‡ªåŠ¨éƒ¨ç½²
- âœ… CDNåŠ é€Ÿ
- âœ… Serverless Functions
- âœ… ç¯å¢ƒå˜é‡ç®¡ç†
- âœ… å…è´¹é¢åº¦å……è¶³

#### é…ç½®ç¤ºä¾‹
```env
# .env.production
NEXT_PUBLIC_SUPABASE_URL=https://tparjdkxxtnentsdazfw.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGci...
SUPABASE_SERVICE_ROLE_KEY=...
OPENAI_API_KEY=sk-...
```

---

## ğŸ’° æˆæœ¬ä¼°ç®—

### åˆæœŸï¼ˆ1000ç”¨æˆ·ä»¥å†…ï¼‰
```
Supabase: å…è´¹
Vercel: å…è´¹
OpenAI API: ~$50/æœˆ
åŸŸå: ~$10/å¹´
æ€»è®¡: ~$50/æœˆ
```

### æˆé•¿æœŸï¼ˆ10000ç”¨æˆ·ï¼‰
```
Supabase Pro: $25/æœˆ
Vercel Pro: $20/æœˆ
OpenAI API: ~$200/æœˆ
CDN: ~$50/æœˆ
æ€»è®¡: ~$295/æœˆ
```

---

## ğŸš€ å¼€å‘è·¯çº¿å›¾

### Phase 1: MVP (4-6å‘¨)
- [ ] é¢˜åº“åŸºç¡€åŠŸèƒ½
- [ ] ç”¨æˆ·æ³¨å†Œç™»å½•
- [ ] ç« èŠ‚ç»ƒä¹ 
- [ ] åŸºç¡€ç»Ÿè®¡

### Phase 2: æ ¸å¿ƒåŠŸèƒ½ (6-8å‘¨)
- [ ] PDFèµ„æ–™ä¸Šä¼ å’Œé¢„è§ˆ
- [ ] æ™ºèƒ½è¯„ä¼°ç³»ç»Ÿ
- [ ] å­¦ä¹ è·¯å¾„æ¨è
- [ ] é”™é¢˜æœ¬

### Phase 3: AIåŠŸèƒ½ (4-6å‘¨)
- [ ] æœºæ„æŠ¼é¢˜åˆ†æ
- [ ] AIç”Ÿæˆé¢˜ç›®
- [ ] AIå­¦ä¹ å»ºè®®

### Phase 4: é«˜çº§åŠŸèƒ½ (æŒç»­)
- [ ] ç¤¾åŒºåŠŸèƒ½
- [ ] ä»˜è´¹ä¼šå‘˜
- [ ] ç§»åŠ¨ç«¯APP
- [ ] æ•°æ®åˆ†æDashboard

---

## âœ… ç«‹å³å¼€å§‹

### ç¬¬1æ­¥ï¼šå®Œå–„Supabaseé…ç½®

1. **åœ¨Dashboardä¸­åˆ›å»ºæ‰€æœ‰è¡¨**
2. **è®¾ç½®Storage buckets**
3. **é…ç½®RLSè§„åˆ™**
4. **ä¸Šä¼ åˆå§‹æ•°æ®**

### ç¬¬2æ­¥ï¼šå¼€å‘æ ¸å¿ƒåŠŸèƒ½

1. **é¢˜åº“CRUD**
2. **ç”¨æˆ·ç­”é¢˜æµç¨‹**
3. **PDFä¸Šä¼ å’Œé¢„è§ˆ**

### ç¬¬3æ­¥ï¼šé›†æˆAI

1. **OpenAI APIé…ç½®**
2. **å®ç°AIå‡ºé¢˜**
3. **å®ç°æ™ºèƒ½åˆ†æ**

---

## ğŸ“š å‚è€ƒèµ„æº

- Supabaseæ–‡æ¡£: https://supabase.com/docs
- Next.jsæ–‡æ¡£: https://nextjs.org/docs
- OpenAI API: https://platform.openai.com/docs
- PDF.js: https://mozilla.github.io/pdf.js/

---

**ç»“è®ºï¼šç»§ç»­ä½¿ç”¨Supabase + Next.js + OpenAIï¼Œè¿™æ˜¯æœ€é€‚åˆä½ é¡¹ç›®çš„æŠ€æœ¯æ ˆï¼** ğŸ‰
