# 🚀 立即导入历年真题到生产环境

## 🔴 核心问题

**您的480道历年真题只在本地，生产环境数据库是空的！**

- ❌ 中药学综合知识与技能 2024年 120道 - 未在生产环境
- ❌ 中药学综合知识与技能 2023年 120道 - 未在生产环境  
- ❌ 中药学综合知识与技能 2022年 120道 - 未在生产环境
- ❌ 中药学专业知识（一）2024年 120道 - 未在生产环境

**总计：480道题目需要导入**

---

## 📋 解决方案步骤

### 步骤1：获取Supabase Service Role Key (2分钟)

1. 打开浏览器，访问：https://supabase.com/dashboard/project/tparjdkxxtnentsdazfw
2. 点击左侧菜单 **Settings** → **API**
3. 找到 **Project API keys** 部分
4. 找到 **service_role** key（⚠️ 注意：不是anon key）
5. 点击"Copy"复制这个key

---

### 步骤2：更新导入脚本 (1分钟)

打开文件：`E:\tiku\import-via-api.ts`

找到第7行：
```typescript
const supabaseServiceKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'; // 替换这里
```

替换为您刚才复制的 `service_role` key

---

### 步骤3：运行导入脚本 (5-10分钟)

打开命令行，运行：

```bash
cd E:\tiku
npx tsx import-via-api.ts
```

**预期输出：**
```
🚀 通过Supabase API导入所有历年真题
══════════════════════════════════════════

──────────────────────────────────────────
📚 导入 2024年 中药学综合知识与技能
──────────────────────────────────────────

📖 读取到 120 道题目
🗑️  清理旧数据...
   ✅ 旧数据已清理

📝 准备导入题目...

   ✅ 进度: 50/120
   ✅ 进度: 100/120
   ✅ 进度: 120/120

   ✅ 成功: 120 道
   ❌ 失败: 0 道

[重复以上过程3次，导入其他3个科目]

══════════════════════════════════════════
📊 导入统计汇总:
══════════════════════════════════════════
   ✅ 总成功: 480 道
   ❌ 总失败: 0 道
══════════════════════════════════════════

🎉 导入完成！

💡 现在访问 https://yikaobiguo.com/practice/history?exam=pharmacist
   应该可以看到所有历年真题了！
```

---

### 步骤4：验证导入结果 (1分钟)

等待1-2分钟后，访问：
```
https://yikaobiguo.com/practice/history?exam=pharmacist
```

**您应该看到：**

#### 2024年真题卡片
- 中药学综合知识与技能：120道 ✅
- 中药学专业知识（一）：120道 ✅

#### 2023年真题卡片  
- 中药学综合知识与技能：120道 ✅

#### 2022年真题卡片
- 中药学综合知识与技能：120道 ✅

**总计：480道历年真题**

---

## 🔧 如果遇到问题

### 问题1：找不到service_role key

**解决：**
1. 确认您已登录 https://supabase.com
2. 确认项目ID是 `tparjdkxxtnentsdazfw`
3. Settings → API → Project API keys → service_role

### 问题2：导入失败 "权限不足"

**解决：**
- 确认使用的是 **service_role** key（不是anon key）
- service_role key通常以 `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRwYXJqZGt4eHRuZW50c2RhemZ3Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSI...` 开头

### 问题3：网页上还是看不到数据

**解决：**
1. 清除浏览器缓存 (Ctrl + Shift + Delete)
2. 等待2-3分钟让Vercel CDN刷新
3. 尝试硬刷新页面 (Ctrl + F5)

---

## 📊 数据文件位置

脚本会自动读取以下文件：

1. `E:\tiku\shuju\2024年执业药师中药师药学综合与技能历年真题.json`
2. `E:\tiku\shuju\2023年执业药师中药师药学综合与技能历年真题.json`
3. `E:\tiku\shuju\2022年执业药师中药师药学综合与技能历年真题.json`
4. `E:\tiku\shuju\2024年执业药师中药药一历年真题\2024年中药药一历年真题.json`

---

## ⚠️ 重要提示

1. **service_role key 是敏感信息**，不要提交到Git
2. 导入完成后，建议将key从脚本中删除
3. 导入过程中不要中断，让它完整运行完毕
4. 如果已经导入过，脚本会自动清理旧数据再导入新的

---

## 🎯 立即执行

```bash
# 步骤1：获取service_role key（去Supabase Dashboard）

# 步骤2：更新import-via-api.ts第7行

# 步骤3：运行导入
cd E:\tiku
npx tsx import-via-api.ts

# 步骤4：验证（等待1-2分钟后）
# 访问 https://yikaobiguo.com/practice/history?exam=pharmacist
```

---

导入完成后，您的网站将立即拥有完整的480道历年真题！🎉
