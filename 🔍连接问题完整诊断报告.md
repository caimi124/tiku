# ğŸ” æ•°æ®åº“è¿æ¥é—®é¢˜ - å®Œæ•´è¯Šæ–­æŠ¥å‘Š

## ğŸ“Š æµ‹è¯•ç»“æœæ€»ç»“

### âœ… æˆåŠŸçš„è¿æ¥
- **Supabase API (HTTPS):** âœ… è¿æ¥æ­£å¸¸
- **é¡¹ç›®çŠ¶æ€:** âœ… Activeï¼ˆæ´»è·ƒï¼‰
- **API è®¤è¯:** âœ… anon key æœ‰æ•ˆ
- **æ•°æ®åº“è¡¨:** âœ… questions è¡¨å·²å­˜åœ¨

### âŒ å¤±è´¥çš„è¿æ¥
- **PostgreSQL ç›´è¿:** âŒ DNS è§£æå¤±è´¥
- **æ•°æ®åº“ä¸»æœº:** `db.tparjdkxxtnentsdazfw.supabase.co`
- **ç«¯å£:** 5432

---

## ğŸ¯ æ ¹æœ¬åŸå› åˆ†æ

### PostgreSQL ç›´è¿å¤±è´¥çš„åŸå› 

**é—®é¢˜ï¼šDNS æ— æ³•è§£ææ•°æ®åº“ä¸»æœºå**

```
ä¸»æœºå: db.tparjdkxxtnentsdazfw.supabase.co
é”™è¯¯: Name resolution failed
```

**æ·±å±‚åŸå› ï¼ˆæŒ‰å¯èƒ½æ€§æ’åºï¼‰ï¼š**

1. **ç½‘ç»œç¯å¢ƒé™åˆ¶ï¼ˆæœ€å¯èƒ½ï¼‰**
   - å…¬å¸æˆ–å­¦æ ¡ç½‘ç»œå¯èƒ½é˜»æ­¢äº†å¤–éƒ¨æ•°æ®åº“è¿æ¥
   - é˜²ç«å¢™è§„åˆ™é˜»æ­¢ 5432 ç«¯å£
   - ç½‘ç»œç­–ç•¥é™åˆ¶ç›´è¿äº‘æ•°æ®åº“

2. **DNS æœåŠ¡å™¨é—®é¢˜**
   - æœ¬åœ° DNS æœåŠ¡å™¨æ— æ³•è§£æ Supabase åŸŸå
   - DNS ç¼“å­˜è¿‡æœŸæˆ–æŸå
   - ISP çš„ DNS æœåŠ¡é—®é¢˜

3. **ç½‘ç»œé…ç½®é—®é¢˜**
   - ä»£ç†è®¾ç½®ä¸æ­£ç¡®
   - è·¯ç”±è§„åˆ™é™åˆ¶
   - VPN å†²çª

**ä¸ºä»€ä¹ˆ API å¯ä»¥å·¥ä½œä½†ç›´è¿ä¸è¡Œï¼Ÿ**

| è¿æ¥æ–¹å¼ | åè®® | ç«¯å£ | çŠ¶æ€ | åŸå›  |
|---------|------|------|------|------|
| Supabase API | HTTPS | 443 | âœ… æ­£å¸¸ | Web æµé‡é€šå¸¸è¢«å…è®¸ |
| PostgreSQL ç›´è¿ | PostgreSQL | 5432 | âŒ å¤±è´¥ | æ•°æ®åº“ç«¯å£é€šå¸¸è¢«é™åˆ¶ |

---

## ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼ˆ3ç§ï¼‰

### æ–¹æ¡ˆ1ï¼šä½¿ç”¨ Supabase Dashboardï¼ˆæ¨èï¼‰â­

**ä¼˜ç‚¹ï¼š**
- âœ… å®Œå…¨ç»•è¿‡ç½‘ç»œé™åˆ¶
- âœ… ä¸éœ€è¦æœ¬åœ°å·¥å…·
- âœ… å›¾å½¢åŒ–ç•Œé¢
- âœ… 100% å¯é 

**æ“ä½œæ­¥éª¤ï¼š**

1. **è®¿é—® Dashboard**
   ```
   https://supabase.com/dashboard/project/tparjdkxxtnentsdazfw
   ```

2. **åˆ›å»ºè¡¨ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰**
   - ç‚¹å‡» "SQL Editor" â†’ "New query"
   - å¤åˆ¶å¹¶è¿è¡Œåˆ›å»ºè¡¨çš„ SQL
   - ç¡®è®¤ questions è¡¨åˆ›å»ºæˆåŠŸ

3. **å¯¼å…¥æ•°æ®**
   - åœ¨ SQL Editor ä¸­ "New query"
   - å¤åˆ¶ `å¯¼å…¥çœŸé¢˜åˆ°tiku2-SQLè„šæœ¬.sql` çš„å†…å®¹
   - è¿è¡Œå¹¶ç¡®è®¤ 3 é“é¢˜ç›®å¯¼å…¥æˆåŠŸ

4. **éªŒè¯æ•°æ®**
   - åœ¨ "Table Editor" ä¸­æŸ¥çœ‹ questions è¡¨
   - åº”è¯¥çœ‹åˆ° 3 æ¡è®°å½•

**è¿™æ˜¯æœ€ç®€å•ã€æœ€å¯é çš„æ–¹å¼ï¼**

---

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨ Supabase JavaScript APIï¼ˆé€‚åˆå¼€å‘ï¼‰

**ä¼˜ç‚¹ï¼š**
- âœ… é€šè¿‡ HTTPS è®¿é—®ï¼ˆç«¯å£ 443ï¼‰
- âœ… å·²ç»æµ‹è¯•æˆåŠŸ
- âœ… é€‚åˆå‰ç«¯åº”ç”¨
- âœ… ç»•è¿‡ PostgreSQL ç«¯å£é™åˆ¶

**å®ç°æ–¹å¼ï¼š**

#### 2.1 å®‰è£…ä¾èµ–
```bash
npm install @supabase/supabase-js
```

#### 2.2 é…ç½®å®¢æˆ·ç«¯
```typescript
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = 'https://tparjdkxxtnentsdazfw.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'; // anon key

const supabase = createClient(supabaseUrl, supabaseKey);
```

#### 2.3 æŸ¥è¯¢æ•°æ®
```typescript
// æŸ¥è¯¢æ‰€æœ‰é¢˜ç›®
const { data, error } = await supabase
  .from('questions')
  .select('*');

// æŸ¥è¯¢2024å¹´çœŸé¢˜
const { data: questions2024 } = await supabase
  .from('questions')
  .select('*')
  .contains('knowledge_points', ['2024å¹´çœŸé¢˜']);
```

#### 2.4 æ’å…¥æ•°æ®
```typescript
const { data, error } = await supabase
  .from('questions')
  .insert([
    {
      exam_type: 'æ‰§ä¸šè¯å¸ˆ',
      subject: 'ä¸­è¯å­¦ç»¼åˆçŸ¥è¯†ä¸æŠ€èƒ½',
      content: 'é¢˜ç›®å†…å®¹...',
      // ... å…¶ä»–å­—æ®µ
    }
  ]);
```

**ä¼˜ç‚¹ï¼šå‰ç«¯å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦åç«¯ APIã€‚**

---

### æ–¹æ¡ˆ3ï¼šä¿®å¤ç½‘ç»œé—®é¢˜ï¼ˆæŠ€æœ¯æ–¹æ¡ˆï¼‰

å¦‚æœç¡®å®éœ€è¦ PostgreSQL ç›´è¿ï¼ˆä½¿ç”¨ Prismaï¼‰ï¼Œå¯ä»¥å°è¯•ï¼š

#### 3.1 ä½¿ç”¨ VPN
- è¿æ¥åˆ°æ”¯æŒæ•°æ®åº“è¿æ¥çš„ VPN
- é‡æ–°æµ‹è¯•è¿æ¥

#### 3.2 æ›´æ¢ DNS æœåŠ¡å™¨
```powershell
# ä½¿ç”¨ Google DNS
# åœ¨ç½‘ç»œé€‚é…å™¨è®¾ç½®ä¸­å°† DNS æ”¹ä¸ºï¼š
ä¸» DNS: 8.8.8.8
å¤‡ DNS: 8.8.4.4

# æˆ–ä½¿ç”¨ Cloudflare DNS
ä¸» DNS: 1.1.1.1
å¤‡ DNS: 1.0.0.1

# æ¸…é™¤ DNS ç¼“å­˜
ipconfig /flushdns
```

#### 3.3 æ£€æŸ¥é˜²ç«å¢™
```powershell
# æµ‹è¯•ç«¯å£è¿é€šæ€§
Test-NetConnection -ComputerName db.tparjdkxxtnentsdazfw.supabase.co -Port 5432

# å¦‚æœå¤±è´¥ï¼Œå¯èƒ½éœ€è¦ï¼š
# 1. å…³é—­é˜²ç«å¢™ï¼ˆä¸´æ—¶æµ‹è¯•ï¼‰
# 2. æ·»åŠ é˜²ç«å¢™è§„åˆ™å…è®¸ 5432 ç«¯å£
# 3. è”ç³»ç½‘ç»œç®¡ç†å‘˜
```

#### 3.4 ä½¿ç”¨ç§»åŠ¨çƒ­ç‚¹
- åˆ‡æ¢åˆ°æ‰‹æœºçƒ­ç‚¹ç½‘ç»œ
- æµ‹è¯•è¿æ¥æ˜¯å¦æˆåŠŸ
- å¦‚æœæˆåŠŸï¼Œè¯´æ˜æ˜¯åŸç½‘ç»œçš„é™åˆ¶

---

## ğŸ¯ æ¨èè¡ŒåŠ¨æ–¹æ¡ˆ

### ç«‹å³å¯åšï¼ˆ5åˆ†é’Ÿï¼‰

**ä½¿ç”¨ Dashboard å¯¼å…¥æ•°æ®ï¼š**

1. æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
   ```
   https://supabase.com/dashboard/project/tparjdkxxtnentsdazfw
   ```

2. SQL Editor â†’ New query

3. å¤åˆ¶å¹¶è¿è¡Œï¼š
   ```sql
   -- æŸ¥çœ‹ questions è¡¨ç»“æ„
   SELECT column_name, data_type 
   FROM information_schema.columns 
   WHERE table_name = 'questions';
   ```

4. å¦‚æœè¡¨ä¸å­˜åœ¨ï¼Œå…ˆåˆ›å»ºè¡¨ï¼ˆä½¿ç”¨åˆ›å»ºè¡¨çš„ SQLï¼‰

5. è¿è¡Œå¯¼å…¥è„šæœ¬ï¼ˆ`å¯¼å…¥çœŸé¢˜åˆ°tiku2-SQLè„šæœ¬.sql`ï¼‰

6. éªŒè¯ï¼š
   ```sql
   SELECT COUNT(*) FROM questions;
   SELECT * FROM questions LIMIT 5;
   ```

### å¼€å‘åº”ç”¨ï¼ˆé•¿æœŸï¼‰

**å‰ç«¯é…ç½®ä½¿ç”¨ APIï¼š**

1. æ›´æ–° `.env.local`ï¼š
   ```env
   NEXT_PUBLIC_SUPABASE_URL=https://tparjdkxxtnentsdazfw.supabase.co
   NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   ```

2. åœ¨åº”ç”¨ä¸­ä½¿ç”¨ Supabase å®¢æˆ·ç«¯

3. ä¸ä½¿ç”¨ Prisma ç›´è¿ï¼ˆæˆ–ä»…åœ¨éƒ¨ç½²ç¯å¢ƒä½¿ç”¨ï¼‰

---

## ğŸ“‹ å½“å‰çŠ¶æ€æ¸…å•

### âœ… å·²å®Œæˆ
- [x] æµ‹è¯• API è¿æ¥ - æˆåŠŸ
- [x] ç¡®è®¤é¡¹ç›®çŠ¶æ€ - Active
- [x] éªŒè¯ questions è¡¨å­˜åœ¨
- [x] è¯Šæ–­ PostgreSQL ç›´è¿é—®é¢˜
- [x] ç¡®å®šæ ¹æœ¬åŸå›  - DNS/ç½‘ç»œé™åˆ¶

### â³ å¾…å®Œæˆ
- [ ] åœ¨ Dashboard ä¸­å¯¼å…¥ 2024 å¹´çœŸé¢˜ï¼ˆ3é“ï¼‰
- [ ] åœ¨ Table Editor ä¸­éªŒè¯æ•°æ®
- [ ] æ›´æ–°å‰ç«¯é…ç½®ä½¿ç”¨ API
- [ ] æµ‹è¯•å‰ç«¯æ•°æ®è·å–

### ğŸ“ å¯é€‰
- [ ] å°è¯•ä¿®å¤ç½‘ç»œé—®é¢˜ï¼ˆå¦‚æœéœ€è¦ Prismaï¼‰
- [ ] å¯¼å…¥æ›´å¤šé¢˜ç›®æ•°æ®
- [ ] é…ç½® Row Level Security (RLS)

---

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆä¸èƒ½ç”¨ Prismaï¼Ÿ
**A:** Prisma éœ€è¦ç›´æ¥è¿æ¥ PostgreSQLï¼ˆç«¯å£ 5432ï¼‰ï¼Œä½†ä½ çš„ç½‘ç»œç¯å¢ƒé˜»æ­¢äº†è¿™ä¸ªè¿æ¥ã€‚å¯ä»¥ä½¿ç”¨ Supabase API æ›¿ä»£ã€‚

### Q: æ•°æ®å®‰å…¨å—ï¼Ÿ
**A:** æ˜¯çš„ã€‚ä½¿ç”¨ Supabase API åŒæ ·å®‰å…¨ï¼Œå¯ä»¥é…ç½® Row Level Security (RLS) æ¥ä¿æŠ¤æ•°æ®ã€‚

### Q: èƒ½å¦ä¸¤ç§æ–¹å¼æ··ç”¨ï¼Ÿ
**A:** å¯ä»¥ã€‚åœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨ Dashboardï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒï¼ˆå¦‚ Vercelï¼‰å¯èƒ½å¯ä»¥ç›´è¿æ•°æ®åº“ã€‚

### Q: è®¿é—®ä»¤ç‰Œæ˜¯ä»€ä¹ˆï¼Ÿ
**A:** ä½ æä¾›çš„ `sbp_0fe...` æ˜¯ Personal Access Tokenï¼Œç”¨äº Supabase CLI æˆ– Management APIï¼Œä¸æ˜¯æ•°æ®åº“è¿æ¥ç”¨çš„ã€‚æ•°æ®åº“æ“ä½œä½¿ç”¨ anon key æˆ– service_role keyã€‚

---

## ğŸ’» æµ‹è¯•å‘½ä»¤æ€»ç»“

### æµ‹è¯• API è¿æ¥ï¼ˆå·²æˆåŠŸï¼‰
```bash
npx tsx test-api-connection.ts
```

### æµ‹è¯• PostgreSQL ç›´è¿ï¼ˆä¼šå¤±è´¥ï¼‰
```bash
npx tsx test-new-db-connection.ts
```

### æµ‹è¯•ç½‘ç»œè¿é€šæ€§
```powershell
Test-NetConnection -ComputerName db.tparjdkxxtnentsdazfw.supabase.co -Port 5432
```

### DNS è§£ææµ‹è¯•
```powershell
nslookup db.tparjdkxxtnentsdazfw.supabase.co
```

---

## ğŸ‰ ç»“è®º

**æ•°æ®åº“æœ¬èº«æ­£å¸¸ï¼Œé—®é¢˜åœ¨äºç½‘ç»œé™åˆ¶ã€‚**

**æœ€ä½³è§£å†³æ–¹æ¡ˆï¼š**
1. âœ… ä½¿ç”¨ Supabase Dashboard åˆ›å»ºè¡¨å’Œå¯¼å…¥æ•°æ®
2. âœ… å‰ç«¯ä½¿ç”¨ Supabase API è®¿é—®æ•°æ®
3. âœ… ä¸ä¾èµ– PostgreSQL ç›´è¿

**ä¼˜åŠ¿ï¼š**
- ç®€å•å¿«é€Ÿ
- ä¸éœ€è¦è§£å†³ç½‘ç»œé—®é¢˜
- å®Œå…¨å¯é 
- é€‚åˆäº‘ç«¯éƒ¨ç½²

**ä¸‹ä¸€æ­¥ï¼š**
è®¿é—® Dashboard å¹¶å¯¼å…¥æ•°æ®ï¼Œå°±å¯ä»¥å¼€å§‹ä½¿ç”¨äº†ï¼

---

**Dashboard é“¾æ¥ï¼š**
https://supabase.com/dashboard/project/tparjdkxxtnentsdazfw

**æ“ä½œæ–‡æ¡£ï¼š**
- `ğŸ¯tiku2å®Œæ•´å¯¼å…¥æŒ‡å—.md`
- `å¯¼å…¥çœŸé¢˜åˆ°tiku2-SQLè„šæœ¬.sql`
- `ğŸš€å¿«é€Ÿé…ç½®tiku2.bat`
