# ğŸ”§ æ•°æ®åº“è¿æ¥é—®é¢˜ä¿®å¤æŒ‡å— - 2024å¹´çœŸé¢˜å¯¼å…¥

## âŒ å½“å‰é—®é¢˜
æ— æ³•è¿æ¥åˆ° Supabase æ•°æ®åº“ï¼š`db.rekdretiemtoofrvcils.supabase.co`

## ğŸ” é—®é¢˜è¯Šæ–­

### 1. æ£€æŸ¥ Supabase é¡¹ç›®çŠ¶æ€

**ç«‹å³è®¿é—®ä½ çš„ Supabase é¡¹ç›®ï¼š**
```
https://supabase.com/dashboard/project/mjyfiryzawngzadfxfoe
```

**ç™»å½•ä¿¡æ¯ï¼š**
- é¡¹ç›®åç§°ï¼šcaimi124's Project
- å¯†ç ï¼šchupingzeng123.

### 2. ç¡®è®¤é¡¹ç›®æ˜¯å¦æš‚åœ

Supabase å…è´¹é¡¹ç›®åœ¨ä»¥ä¸‹æƒ…å†µä¼šè‡ªåŠ¨æš‚åœï¼š
- âœ“ è¶…è¿‡7å¤©æœªä½¿ç”¨
- âœ“ æ•°æ®åº“é—²ç½®æ—¶é—´è¿‡é•¿

**è§£å†³æ–¹æ³•ï¼š**
1. ç™»å½• Supabase Dashboard
2. æ‰¾åˆ°é¡¹ç›® `mjyfiryzawngzadfxfoe`
3. å¦‚æœæ˜¾ç¤º "Paused" æˆ– "æš‚åœ"ï¼Œç‚¹å‡» **"Resume Project"** æˆ– **"æ¢å¤é¡¹ç›®"** æŒ‰é’®
4. ç­‰å¾… 1-2 åˆ†é’Ÿé¡¹ç›®å®Œå…¨å¯åŠ¨

### 3. è·å–æ­£ç¡®çš„æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²

ç™»å½• Supabase åï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤è·å–è¿æ¥å­—ç¬¦ä¸²ï¼š

1. è¿›å…¥é¡¹ç›®ï¼šhttps://supabase.com/dashboard/project/mjyfiryzawngzadfxfoe
2. ç‚¹å‡»å·¦ä¾§èœå• **"Project Settings"** (é½¿è½®å›¾æ ‡)
3. ç‚¹å‡» **"Database"** é€‰é¡¹å¡
4. æ‰¾åˆ° **"Connection string"** éƒ¨åˆ†
5. é€‰æ‹© **"URI"** æ ¼å¼
6. å¤åˆ¶è¿æ¥å­—ç¬¦ä¸²ï¼ˆç±»ä¼¼è¿™æ ·ï¼‰ï¼š
   ```
   postgresql://postgres:[YOUR-PASSWORD]@db.rekdretiemtoofrvcils.supabase.co:5432/postgres
   ```
7. å°† `[YOUR-PASSWORD]` æ›¿æ¢ä¸ºä½ çš„å¯†ç ï¼š`yZaNnwx8VfkVRVkk`

### 4. æ£€æŸ¥ç½‘ç»œè¿æ¥

æœ‰æ—¶éœ€è¦æµ‹è¯•ç½‘ç»œè¿æ¥ï¼š

```powershell
# æµ‹è¯•æ•°æ®åº“ä¸»æœºè¿é€šæ€§
Test-NetConnection -ComputerName db.rekdretiemtoofrvcils.supabase.co -Port 5432
```

## ğŸš€ å¿«é€Ÿä¿®å¤æ­¥éª¤

### æ­¥éª¤ 1: æ¢å¤ Supabase é¡¹ç›®

1. è®¿é—®ï¼šhttps://supabase.com/dashboard
2. ä½¿ç”¨ä½ çš„è´¦å·ç™»å½•
3. æ‰¾åˆ°å¹¶ç‚¹å‡»é¡¹ç›® `caimi124's Project`
4. å¦‚æœæ˜¾ç¤ºæš‚åœï¼Œç‚¹å‡» **"Resume Project"** æŒ‰é’®
5. ç­‰å¾…é¡¹ç›®çŠ¶æ€å˜ä¸º **"Active"** (ç»¿è‰²)

### æ­¥éª¤ 2: éªŒè¯æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²

ä½ æä¾›çš„è¿æ¥å­—ç¬¦ä¸²ï¼š
```
postgresql://postgres:yZaNnwx8VfkVRVkk@db.rekdretiemtoofrvcils.supabase.co:5432/postgres
```

è¯·åœ¨ Supabase Dashboard ä¸­ç¡®è®¤ï¼š
- âœ“ ä¸»æœºåæ˜¯å¦åŒ¹é…
- âœ“ å¯†ç æ˜¯å¦æ­£ç¡®
- âœ“ ç«¯å£æ˜¯å¦ä¸º 5432

### æ­¥éª¤ 3: åˆ›å»º .env.local æ–‡ä»¶

åœ¨é¡¹ç›®æ ¹ç›®å½• `e:\tiku\` åˆ›å»º `.env.local` æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```env
# æ•°æ®åº“é…ç½®
DATABASE_URL="postgresql://postgres:yZaNnwx8VfkVRVkk@db.rekdretiemtoofrvcils.supabase.co:5432/postgres"

# NextAuth é…ç½®
NEXTAUTH_SECRET="your-secret-key-change-in-production-123456"
NEXTAUTH_URL="http://localhost:3000"

# å…¶ä»–é…ç½®ï¼ˆå¯é€‰ï¼‰
NODE_ENV="development"
NEXT_PUBLIC_SITE_URL="http://localhost:3000"
```

### æ­¥éª¤ 4: åˆå§‹åŒ–æ•°æ®åº“è¡¨ç»“æ„

é¡¹ç›®æ¢å¤åï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºæ•°æ®åº“è¡¨ï¼š

```powershell
# åŒæ­¥æ•°æ®åº“ç»“æ„
npx prisma db push

# ç”Ÿæˆ Prisma Client
npx prisma generate
```

### æ­¥éª¤ 5: æµ‹è¯•æ•°æ®åº“è¿æ¥

```powershell
# è¿è¡Œæµ‹è¯•è„šæœ¬
npx tsx test-db-connection.ts
```

### æ­¥éª¤ 6: å¯¼å…¥ 2024 å¹´çœŸé¢˜

ä¸€æ—¦æ•°æ®åº“è¿æ¥æˆåŠŸï¼Œè¿è¡Œï¼š

```powershell
# æ–¹å¼1: ä½¿ç”¨æˆ‘åˆ›å»ºçš„æ–°è„šæœ¬
npx tsx setup-db-2024.ts

# æ–¹å¼2: ä½¿ç”¨åŸæœ‰çš„å¯¼å…¥è„šæœ¬
npx tsx prisma/import-2024-zhongyao.ts
```

## ğŸ“ å®Œæ•´çš„ 2024 å¹´çœŸé¢˜æ•°æ®

ç›®å‰å¯¼å…¥è„šæœ¬åªåŒ…å« **3 é“ç¤ºä¾‹é¢˜ç›®**ã€‚å¦‚æœä½ æœ‰å®Œæ•´çš„ 120 é“ 2024 å¹´çœŸé¢˜æ•°æ®ï¼Œè¯·ï¼š

### é€‰é¡¹ Aï¼šæ‰‹åŠ¨æ·»åŠ é¢˜ç›®åˆ°è„šæœ¬

ç¼–è¾‘ `setup-db-2024.ts` æ–‡ä»¶ï¼Œåœ¨ `questions2024` æ•°ç»„ä¸­æ·»åŠ æ‰€æœ‰é¢˜ç›®ã€‚

æ ¼å¼ç¤ºä¾‹ï¼š
```typescript
{
  examType: 'æ‰§ä¸šè¯å¸ˆ',
  subject: 'ä¸­è¯å­¦ç»¼åˆçŸ¥è¯†ä¸æŠ€èƒ½',
  chapter: 'ç« èŠ‚åç§°',
  questionType: 'single',  // single/multiple/judge
  content: 'é¢˜ç›®å†…å®¹',
  options: [
    { key: 'A', value: 'é€‰é¡¹A' },
    { key: 'B', value: 'é€‰é¡¹B' },
    { key: 'C', value: 'é€‰é¡¹C' },
    { key: 'D', value: 'é€‰é¡¹D' },
    { key: 'E', value: 'é€‰é¡¹E' },
  ],
  correctAnswer: 'A',
  explanation: 'ç­”æ¡ˆè§£æ',
  difficulty: 2,  // 1-5
  knowledgePoints: ['çŸ¥è¯†ç‚¹1', 'çŸ¥è¯†ç‚¹2', '2024å¹´çœŸé¢˜'],
  isPublished: true,
},
```

### é€‰é¡¹ Bï¼šä» Excel/CSV å¯¼å…¥

å¦‚æœä½ æœ‰ Excel æˆ– CSV æ ¼å¼çš„é¢˜ç›®æ•°æ®ï¼Œæˆ‘å¯ä»¥å¸®ä½ åˆ›å»ºå¯¼å…¥è„šæœ¬ã€‚

### é€‰é¡¹ Cï¼šä½¿ç”¨æ•°æ®åº“ç§å­æ•°æ®

è¿è¡Œå®Œæ•´çš„æ•°æ®åº“åˆå§‹åŒ–ï¼š
```powershell
npx prisma db seed
```

## ğŸ¯ å‰ç«¯æŸ¥çœ‹ 2024 å¹´çœŸé¢˜

æ•°æ®å¯¼å…¥æˆåŠŸåï¼Œå‰ç«¯éœ€è¦æ­£ç¡®æŸ¥è¯¢ï¼š

```typescript
// æŸ¥è¯¢ 2024 å¹´çœŸé¢˜çš„ç¤ºä¾‹ä»£ç 
const questions = await prisma.question.findMany({
  where: {
    examType: 'æ‰§ä¸šè¯å¸ˆ',
    subject: 'ä¸­è¯å­¦ç»¼åˆçŸ¥è¯†ä¸æŠ€èƒ½',
    knowledgePoints: {
      has: '2024å¹´çœŸé¢˜'  // é€šè¿‡æ ‡ç­¾ç­›é€‰
    },
    isPublished: true,
  },
  orderBy: {
    createdAt: 'desc'
  }
});
```

## ğŸ†˜ ä»ç„¶æœ‰é—®é¢˜ï¼Ÿ

### å¸¸è§é”™è¯¯æ’æŸ¥

#### é”™è¯¯ 1: "Can't reach database server"
**åŸå› ï¼š** Supabase é¡¹ç›®æš‚åœæˆ–ç½‘ç»œé—®é¢˜
**è§£å†³ï¼š** ç™»å½• Dashboard æ¢å¤é¡¹ç›®

#### é”™è¯¯ 2: "password authentication failed"
**åŸå› ï¼š** æ•°æ®åº“å¯†ç é”™è¯¯
**è§£å†³ï¼š** åœ¨ Supabase Dashboard é‡ç½®æ•°æ®åº“å¯†ç 

#### é”™è¯¯ 3: "relation 'questions' does not exist"
**åŸå› ï¼š** æ•°æ®åº“è¡¨æœªåˆ›å»º
**è§£å†³ï¼š** è¿è¡Œ `npx prisma db push`

#### é”™è¯¯ 4: "Environment variable not found: DATABASE_URL"
**åŸå› ï¼š** æœªåˆ›å»º .env.local æ–‡ä»¶
**è§£å†³ï¼š** å‚è€ƒæ­¥éª¤ 3 åˆ›å»ºé…ç½®æ–‡ä»¶

### è·å–æ–°çš„æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²

å¦‚æœè¿æ¥å­—ç¬¦ä¸²ä¸æ­£ç¡®ï¼Œè·å–æ–°çš„ï¼š

1. ç™»å½• https://supabase.com/dashboard
2. é€‰æ‹©é¡¹ç›® `mjyfiryzawngzadfxfoe`
3. Settings â†’ Database
4. Connection string â†’ URI
5. å¤åˆ¶å®Œæ•´å­—ç¬¦ä¸²å¹¶æ›¿æ¢å¯†ç 

## ğŸ“ éœ€è¦è¿›ä¸€æ­¥å¸®åŠ©

å¦‚æœä»¥ä¸Šæ­¥éª¤éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼Œè¯·æä¾›ï¼š

1. Supabase é¡¹ç›®å½“å‰çŠ¶æ€æˆªå›¾
2. è¿è¡Œ `npx tsx test-db-connection.ts` çš„å®Œæ•´è¾“å‡º
3. `.env.local` æ–‡ä»¶å†…å®¹ï¼ˆéšè—å¯†ç ï¼‰
4. ä½ çš„ 2024 å¹´çœŸé¢˜æ•°æ®æ ¼å¼ï¼ˆå¦‚æœæœ‰å®Œæ•´æ•°æ®ï¼‰

---

**ä¸‹ä¸€æ­¥æ“ä½œï¼š**
1. âœ… ç«‹å³è®¿é—® Supabase Dashboard æ¢å¤é¡¹ç›®
2. âœ… åˆ›å»º .env.local é…ç½®æ–‡ä»¶
3. âœ… è¿è¡Œ `npx prisma db push` åˆå§‹åŒ–æ•°æ®åº“
4. âœ… è¿è¡Œ `npx tsx setup-db-2024.ts` å¯¼å…¥çœŸé¢˜
