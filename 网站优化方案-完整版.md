# 🎯 医药考试通网站优化方案

## 一、核心问题诊断

| 问题 | 现状 | 影响 | 优先级 |
|-----|------|------|-------|
| **知识点无结构** | 用户只能按年份刷题，不知道学了什么 | 学习效率低，无法针对性复习 | 🔴 P0 |
| **无掌握度反馈** | 用户不知道哪些会、哪些不会 | 盲目刷题，浪费时间 | 🔴 P0 |
| **数据显示异常** | 真题总数显示0 | 用户信任度下降 | 🔴 P0 |
| **缺少学习闭环** | 没有复习提醒、薄弱点分析 | 用户留存率低 | 🟡 P1 |
| **信息密度低** | 页面空白多，关键信息不突出 | 用户体验差 | 🟡 P1 |

---

## 二、已完成的工作

### ✅ 1. 知识点数据结构
- 创建了 `knowledge_tree` 表存储树状知识点
- 导入了西药药二 79 条知识点数据（5章 15节 58个考点）
- 支持章节 → 小节 → 知识点三级结构

### ✅ 2. 用户掌握度追踪
- 创建了 `user_knowledge_mastery` 表
- 创建了 `learning_records` 表
- 支持计算掌握度、标记薄弱点

### ✅ 3. 前端页面开发
- `/dashboard` - 学习仪表盘页面
- `/knowledge` - 知识图谱页面
- `/api/knowledge-tree` - 知识点树API

---

## 三、新增页面预览

### 3.1 学习仪表盘 `/dashboard`

```
┌─────────────────────────────────────────────────────────────┐
│  📊 学习仪表盘                                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│  │  68%    │ │ 12.5h   │ │  76%    │ │   23    │           │
│  │总掌握度  │ │本周学习  │ │ 正确率  │ │薄弱考点  │           │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
│                                                             │
│  📈 各章节掌握情况                                           │
│  ├─ 第2章 解热镇痛抗炎药  ████████░░ 78% ✓已掌握            │
│  ├─ 第3章 呼吸系统用药    ██████░░░░ 65% ⚠需复习            │
│  ├─ 第4章 消化系统用药    ███░░░░░░░ 32% ✗薄弱              │
│  └─ 第5章 心血管系统用药  █████████░ 85% ✓已掌握            │
│                                                             │
│  🔥 今日推荐复习（基于艾宾浩斯遗忘曲线）                      │
│  ├─ 1. 质子泵抑制剂的临床应用  ★★★★★  正确率60%            │
│  ├─ 2. 头孢菌素类分代特点      ★★★★★  正确率45%            │
│  └─ 3. 利尿药不良反应对比      ★★★★☆  正确率55%            │
│                                                             │
│  [开始今日复习]                                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 知识图谱 `/knowledge`

```
┌─────────────────────────────────────────────────────────────┐
│  📚 知识图谱                                                 │
│  药学专业知识（二）- 西药 · 一眼看清掌握情况                   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  🔍 搜索知识点...    [全部] [只看薄弱] [只看高频]            │
│                                                             │
│  图例: ✓已掌握(≥80%) ⚠需复习(60-79%) ✗薄弱(<60%) ○未学习   │
│                                                             │
│  ▼ 第2章 解热、镇痛、抗炎药              ████████░░ 78%     │
│    ├─▼ 2.1 解热镇痛抗炎药                █████████░ 85%     │
│    │   ├─ ✓ 考点1 药物分类与作用机制 ★★★★★  92% [练习]    │
│    │   ├─ ✓ 考点2 阿司匹林临床评价   ★★★★★  88% [练习]    │
│    │   └─ ⚠ 考点3 对乙酰氨基酚评价   ★★★★☆  65% [练习]    │
│    │                                                        │
│    └─▼ 2.3 抗痛风药                      ██████░░░░ 65%     │
│        ├─ ✓ 考点1 药物分类与机制     ★★★★☆  82% [练习]    │
│        ├─ ✗ 考点2 秋水仙碱临床评价   ★★★★★  45% [练习]    │
│        └─ ○ 考点4 抑制尿酸生成药     ★★★★☆   0% [练习]    │
│                                                             │
│  ▶ 第3章 呼吸系统用药                    ██████░░░░ 65%     │
│  ▶ 第4章 消化系统用药                    ███░░░░░░░ 32%     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 四、核心功能说明

### 4.1 掌握度计算算法

```typescript
掌握度 = 基础正确率(40%) + 最近表现(30%) + 时间衰减(20%) + 难度加权(10%)

状态判定:
- ≥80%: 已掌握 (绿色 ✓)
- 60-79%: 需复习 (黄色 ⚠)
- <60%: 薄弱 (红色 ✗)
- 0%: 未学习 (灰色 ○)
```

### 4.2 艾宾浩斯复习提醒

```
掌握度等级 → 复习间隔
0-20%  → 1天后复习
20-40% → 2天后复习
40-60% → 4天后复习
60-80% → 7天后复习
80-100% → 15天后复习
```

### 4.3 知识点树结构

```
科目 (xiyao_yaoxue_er)
├── 章节 (chapter)
│   ├── 小节 (section)
│   │   ├── 知识点 (knowledge_point)
│   │   │   ├── 标题
│   │   │   ├── 内容
│   │   │   ├── 类型 (适应证/禁忌/不良反应...)
│   │   │   ├── 重要性 (1-5星)
│   │   │   ├── 记忆口诀
│   │   │   └── 所属药物
```

---

## 五、数据库表结构

### 已创建的表

| 表名 | 用途 | 记录数 |
|-----|------|-------|
| `knowledge_tree` | 知识点树状结构 | 79条 |
| `user_knowledge_mastery` | 用户掌握度 | 0条 |
| `learning_records` | 学习记录 | 0条 |

### 表关系

```
knowledge_tree (知识点)
    ↓ 1:N
user_knowledge_mastery (用户掌握度)
    ↑ N:1
auth.users (用户)
    ↓ 1:N
learning_records (学习记录)
```

---

## 六、下一步工作

### Phase 1: 数据完善（本周）
- [ ] 导入更多科目的知识点数据
- [ ] 将现有真题与知识点关联
- [ ] 修复真题页面数据显示问题

### Phase 2: 功能联通（下周）
- [ ] 答题时自动更新掌握度
- [ ] 实现薄弱点专项练习
- [ ] 实现今日复习推荐

### Phase 3: 体验优化（第三周）
- [ ] 添加学习热力图
- [ ] 添加学习报告
- [ ] 移动端适配

---

## 七、访问地址

开发完成后可访问:
- 学习仪表盘: https://yikaobiguo.com/dashboard
- 知识图谱: https://yikaobiguo.com/knowledge

---

## 八、技术栈

- **前端**: Next.js 14 + TypeScript + Tailwind CSS
- **数据库**: Supabase (PostgreSQL)
- **部署**: Vercel
- **图标**: Lucide React
